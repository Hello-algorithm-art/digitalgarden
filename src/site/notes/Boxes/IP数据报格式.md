---
{"dg-publish":true,"permalink":"/Boxes/IP数据报格式/","dgPassFrontmatter":true,"created":"2025-05-27T10:53:26.118+08:00","updated":"2025-06-02T14:53:01.625+08:00"}
---

![file-20250527105352688.png](/img/user/images/IP%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%A0%BC%E5%BC%8F/file-20250527105352688.png)
1. 版本号，4bit，IPv4还是IPv6
2. 首部长度，4bit，单位：4B
	1. 首部固定部分20字节，所以首部长度字段最小值为5
	2. 首部长度字段最大表示15，表示首部60字节
	3. 不满4B需要填充
3. 区分服务8位
4. 总长度，16位，首部加数据部分的总长度
	1. 一个链路层能承载的最大数据量称为最大传送单元MTU，如以太网MTU=1500字节
	2. 如果IP数据报超出MTU，需要进行[[Boxes/IP数据报的分片\|IP数据报的分片]]


5. 标识，16bit，标识哪些分片属于同一数据报
6. 标志，3bit，最低位MF=1表示后面还有分片，次低位DF=1 表示不允许分片。保留位必须为0
7. 片偏移，13bit，该分片在原数据报第几位，除以8B

8. 生存时间，8bit，避免IP数据报永久兜圈
9. 协议字段，8bit，IP数据报的数据部分是何种协议数据单元 ![file-20250602144310623.png|500](/img/user/images/IP%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%A0%BC%E5%BC%8F/file-20250602144310623.png)
10. 首部检验和，16bit，检测首部在传输过程中是否出现传输差错
	- 先将检验和置全0，首部每16位求和，取反码加入检验和字段
	- 接收端，求和之后取反码，结果为全0则保留
